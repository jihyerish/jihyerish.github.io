import{K as a,C as V,S as H,U as Z,c as j,d as Y,e as Q}from"./bbkitAssets/privateui-7dfe9fcd.js";import{R as x,M as U,d as s}from"./bbkitAssets/sortview.web-bc5e2455.js";import{R as z}from"./bbkitAssets/rplus-renderer-fec953cb.js";const L=new x.Logger(U),q={ON:!0,OFF:!1,TRUE:!0,FALSE:!1};function y(e){return function(){return arguments[e]}}function w(e){return function(){return arguments[e].toLowerCase()}}function N(e){return function(){return parseInt(arguments[e],10)}}function b(e){return function(){return q[arguments[e]]}}const R={WL:{value:{workerLogging:!0}},NOCACHE:{value:{ignoreCache:!0}},NOCODECACHE:{value:{useCodeCache:!1,dedicatedToiler:!0}},NOCRASHSTACK:{value:{disableErrorReports:!0}},TRANSLATE:{value:{generateTranslations:!0}},DEBUGBUNDLES:{value:{debugBundles:!0,ignoreCache:!0}},NAMEDFUNCTIONS:{value:{enableNamedFunctions:!0}},TRACEHSL:{value:{traceHsl:!0}},DLPROFILE:{value:{enableDiagnostics:!0,datalayerProfiling:!0}},DLARCHIVE:{value:{enableDiagnostics:!0,datalayerSerialization:!0}},TL:{value:{twolineOverride:!0}},HL:{value:{headlessOverride:!0}},RKEY:{reg:/^([A-Za-z0-9]+)$/,value:{resolutionKey:w(1)}},CKEY:{reg:/^([A-Za-z0-9]+)$/,value:{configurationResolutionKey:w(1)}},RT:{reg:/^([A-Z0-9]+)$/,value:{machineOverride:w(1)}},RTD:{reg:/^([A-Z0-9]+)$/,value:{useDevResolve:!0,machineOverride:w(1),disableErrorReports:!0}},WPX:{reg:/^([A-Z0-9_\-]+)$/,value:{workerPrefix:w(1)}},WKM:{value:{launchWorkerMonitor:!0}},V:{reg:/^([0-5])$/,value:{verbosity:N(1)}},C:{value:{enableConsole:!0}},HSLVERBOSITY:{reg:/^([0-5])$/,value:{hslVerbosity:N(1)}},STAGE:{reg:/^([0-5])$/,value:{stageOverride:N(1)}},IU:{reg:/^([0-9]+)$/,value:{impersonateUuid:N(1)}},THEME:{reg:/^([A-Za-z0-9]+)$/,value:{theme:y(1)}},PALETTE:{reg:/^([A-Za-z0-9]+)$/,value:{palette:y(1)}},LANG:{reg:/^([1-9]|10|11|([A-Z]+(-[A-Z]+)*))$/,value:{locale:y(1)}},FRAK:[{reg:/^(ON|OFF)$/,value:{useFrak:b(1)}},{reg:/^([A-F0-9]{16})$/,value:{frakExecution:y(1)}}],CPUPROFILE:{reg:/^(?:([A-Z0-9_\-\.]+){1}(?::([A-Z_\-]+))?(?::([A-Z_\-]+))?)?$/,value:{cpuProfiling:function(){const e={};return 1<arguments.length&&arguments[1]&&(e.outputFile=arguments[1].toLowerCase()),2<arguments.length&&arguments[2]&&(e.automatic={start:arguments[2]},3<arguments.length&&arguments[3]&&(e.automatic.stop=arguments[3])),e}}},SBOX:{value:{runInSandbox:!0}},AUTOMATION:{reg:/^(?:(\d{4,5})(?:\/(\w+)|$)|$)$/,value:{automation:!0,automationPort:N(1),automationSession:y(2)}},REALMSHARING:{reg:/^(ON|OFF)$/,value:{realmSharing:b(1)}},USESTRICT:{reg:/^(ON|OFF)$/,value:{enforceModulesUseStrict:b(1),dedicatedToiler:!0}},TRACEMODULES:{value:{enableModuleTracing:!0}}},E=new RegExp(/\/\/([A-Za-z0-9_\-]+)(?::([^\s]+))*(\s+|$)/g),S={Govt:a.getBKeyInfo("Govt"),Corp:a.getBKeyInfo("Corp"),Mtge:a.getBKeyInfo("Mtge"),Mmkt:a.getBKeyInfo("Mmkt"),Muni:a.getBKeyInfo("Muni"),Pfd:a.getBKeyInfo("Pfd"),Equity:a.getBKeyInfo("Equity"),Comdty:a.getBKeyInfo("Comdty"),Index:a.getBKeyInfo("Index"),Curncy:a.getBKeyInfo("Curncy"),Client:a.getBKeyInfo("Client")},J=new Set(["B","D","P","Q","S","X","Y","AI","CU","CV","IB","LC","MK","NB","NO","PA","QX","RP","XQ","YC","AVX","BLP","IAM","IBL","INQ","LPS","LLP","MLN","MLT","NOW","PAN","PAR","SYS","XCU","CLIP","CONN","CWIZ","DIAG","DNET","FAXP","GRIB","GTKD","LAST","LOGX","LOGZ","MSGN","MSGZ","OFF","LOFF","LPHP","LPFT","PSET","RDE","RDEL","SNIP","SC2L","VERS","VSAT","VSAT1","VSAT2","VSAT3","VSAT4","VSAT5","VSAT6","VSAT7","VSAT8","VWHO","YJPN"]),ee=new Set(["BFON","CNF","LPS","MSGZ","BLP","FXST","FXTG","INQ","LLP","LPHP","LPFT","MSGN","RDEL","RDE","RFQ","RFQC","RFQE","SC2L","STA","TCNF","XB","XS"]),te=["configuration","configurationPath","impersonateUuid","loaderAugmentation","loaderConfiguration","localBundlesToResolve","localConfigurationPath","machineOverride","stageOverride","useDevResolve"],_=new RegExp("\xA0","g");function K(e){for(const t in S){const n=S[t];if(e.toLowerCase()===n.keyBbk||e===n.keyString||e.toLowerCase()===`<${n.keyString.toLowerCase()}>`)return n}}function G(e,t,n){for(const r in e)s.isFunction(e[r])?n[r]=e[r].apply(void 0,t):s.isObject(e[r])?(n[r]={},G(e[r],t,n[r])):n[r]=e[r];return n}function ne(e){return te.some(function(t){return t in e})}function $(e,t,n,r){if(s.isObject(t)){s.assert(t.value);const i=t.reg;let o;if(i){if(2>=n.length)throw new Error("Could not parse option: "+e);if(o=i.exec(n[2]||""),!o)throw new Error("Could not parse option: "+e)}G(t.value,o,r)}else if(s.isArray(t)){let i=t.length;for(let o=0;o<t.length;++o)try{$(e,t[o],n,r)}catch{--i;continue}if(i===0)throw new Error("Could not parse option: "+e)}}var F={YellowKeys:S,getYellowKey:K,isNewFunction:function(e,t){switch(e.terminator){case a.BKeys.Menu:case a.BKeys.Back:case a.BKeys.PageBack:case a.BKeys.PageFwd:case a.BKeys.Panel:case a.BKeys.Print:case a.BKeys.Command:return!1;case a.BKeys.Go:{const n=e.mnemonic.trim().toUpperCase();return n.length>0&&!n.match(/^[0-9]+$/)&&(t||!this.isTwolineFunction(e))||e.securities&&e.securities.length>0}case a.BKeys.Cancel:default:return!0}},isTwolineFunction(e){const t=e.mnemonic.trim().toUpperCase();return J.has(t)||this.isHeadlessTwoline(e)},isQuoteCommand:function(e){return e.mnemonic==="Q"||e.mnemonic==="QX"||e.mnemonic==="XQ"||e.mnemonic==="MK"||e.terminator===a.BKeys.Quote1||e.terminator===a.BKeys.Quote2},isLaunchComponentCommand:function(e){return e.mnemonic==="LLP"},createCommand:function(e,t){if(!e)return;L.debug("Got command: ",e),s.isString(e)||(e.mnemonic&&!s.isString(e.mnemonic)&&s.deprecate("mnemonic",2015,8,1,"'mnemonic' must be a string"),e.securities&&!s.isArray(e.securities)&&s.deprecate("securities",2015,8,1,"'securities' must be an array"),e.tails&&!s.isString(e.tails)&&s.deprecate("tails",2015,8,1,"'tails' must be a string"),e.target&&!s.isString(e.target)&&s.deprecate("target",2015,8,1,"'target' must be a string"),e.options&&!s.isObject(e.options)&&s.deprecate("options",2015,8,1,"'options' must be an object"),e.terminator&&!s.isNumber(e.terminator)&&s.deprecate("terminator",2015,8,1,"'terminator' must be a number"));let n=e.text,r=e.mnemonic||"",i=e.securities||[],o=e.tails||"";const g=e.terminator||a.BKeys.Go;let u=e.target||"REPLACE_TAB";const T=e.options||{};let h;if(n&&(n=n.replace(_," ")),n&&i.length===0){const c=n.match(/^(FIFW|NXTW) /);h=c&&c[1]||void 0}if(r===""&&i.length===0){const c=typeof e=="string"?e.replace(_," "):typeof e=="object"&&n?n:"",O=new Set;for(const l in S){const f=S[l];O.add(f.keyBbk),O.add(`<${f.keyString}>`)}const k=new RegExp(`^(.*)(${Array.from(O.keys()).join("|")})(.*)$`,"i"),d=c.trim().split(" ").reduce(function(l,f){const C=f.match(k);return C?(C[1]&&l.push(C[1]),l.push(C[2]),C[3]&&l.push(C[3])):f&&l.push(f),l},[]);let W=0,A=0;i=[],o="";for(let l=0;l<d.length;l++){const f=d[l],C=K(f);if(C){A=l;const X=d.slice(W,A).join(" ").toUpperCase();i.push(X+" "+C.keyString),W=l+1,h&&i.length===1&&i[0].indexOf(h)===0&&(h=void 0)}}if(i.length===0){let l=0;const f=d[0]&&d[0].toUpperCase();(f==="FIFW"||f==="NXTW")&&(l=1,h=f,u="NEW_TAB"),r=d[l]||"",o=d.slice(l+1).join(" ")}else r=d[A+1]||"",A+2<d.length&&(o=d.slice(A+2).join(" "))}const v=new RegExp("<[^\\s]+>","g");r=r.toUpperCase().replace(v,function(c){return c.toLowerCase()}).trim(),o=o.toUpperCase().replace(v,function(c){return c.toLowerCase()}).trim();let p=i.join(" ");if(r==="FIFW"||r==="NXTW"){h||(h=r);const c=o.split(/\s+/);c.length>0&&(r=c[0],o=c.slice(1).join(" ")),u="NEW_TAB"}if(h)p.length>0&&(p+=" "),p+=h;else if(t){let c="";p.length>0&&(c=" "),u&&u==="NEW_WINDOW"?p+=c+"FIFW":u&&u!=="REPLACE_TAB"&&u!=="LEGACY_PANEL"&&(p+=c+"NXTW")}return r&&(p.length>0&&(p+=" "),p+=r),o&&(p+=" "+o),{securities:i,mnemonic:r,tails:o,terminator:g,target:u,text:p,displayText:e.displayText?e.displayText:"",options:T}},isHeadlessTwoline(e){let t;if(s.isObject(e)&&s.isString(e.mnemonic))t=e.mnemonic;else if(s.isString(e))t=e;else return L.error("'isHeadlessTwoline', only accepts either a) an instance of sys-blp-platform.Command object with the 'mnemonic' property set, or b) a string that contains a Bloomberg mnemonic. cmd: ",e),!1;return ee.has(t.trim().toUpperCase())},parseCommandLine:function(e){const t=[],n={},r=[];let i="",o=0;for(E.lastIndex=0;E.lastIndex<e.length;){const g=E.exec(e);if(!g){i+=e.substring(o);break}const u=g[1].toUpperCase();if(!(u in R)){L.warn("Unrecognized option: ",u),t.push({option:u,line:g.index,reason:"invalid"}),i+=e.substring(o,E.lastIndex),o=E.lastIndex;continue}i+=e.substring(o,e.indexOf(g[1])-2),r.push(g[0].trim()),o=E.lastIndex;const T=R[u];if(T.deprecated){L.warn("Dropping deprecated option: ",u),t.push({option:u,line:g.index,reason:"deprecated"});continue}$(u,T,g,n)}return ne(n)&&(n.runInSandboxIfNeeded=!0),{options:n,remainingCmdLine:i,strippedCmdLine:r.join(" "),warnings:t}}};let I={openUrl:e=>{window.open(e,"_blank")},runCommand:(e,t)=>{const r=`https://blinks.bloomberg.com/screens/${encodeURIComponent(e.text)}`;I.openUrl(r)}};var re={setLaunchDelegate:e=>{I=e},getLaunchDelegate:()=>I};new x.Logger(U);const M={REPLACE_TAB:"REPLACE_TAB",NEW_TAB:"NEW_TAB",NEW_TAB_BG:"NEW_TAB_BG",NEW_WINDOW:"NEW_WINDOW"},D={PANEL_1:"0",PANEL_2:"1",PANEL_3:"2",PANEL_4:"3"},m={WEB:"WEB",MAIL:"MAIL",COMMAND:"COMMAND",UNKNOWN:"UNKNOWN"},oe=/^(http|https|ftp|bbg):\/\/(.+)$/i,ie=/^(bb|bloomberg):\/\/(.+)$/i,se=/^\S+:\/\/.+$/,ae=/^mailto:(.+)$/i,ue=/^www\.(.+)/i;function B(e){const t=F.createCommand(e);return F.createCommand({securities:t.securities,mnemonic:t.mnemonic,tails:t.tails})}function le(e){s.assert.isString(e);const t=e.replace(/\s/g," ");if(!t)return{type:m.UNKNOWN,content:t};if(ue.test(t))return{type:m.WEB,content:"https://"+t};if(oe.test(t))return{type:m.WEB,content:t};let n;return(n=t.match(ie))?{type:m.COMMAND,content:B(n[2])}:(n=t.match(ae))?{type:m.MAIL,content:B("MSG "+n[1])}:t.match(se)?{type:m.UNKNOWN,content:t}:{type:m.COMMAND,content:B(t)}}function ce(e,t={}){const n=re.getLaunchDelegate();if(e.type===m.UNKNOWN)throw new Error("The type of the link is UNKNOWN");if(!e.content)throw new Error("The content of the link is empty");if(e.type===m.WEB){n.openUrl(e.content);return}let r=M.REPLACE_TAB,i;const o=t.target;if(o)if(M.hasOwnProperty(o))r=o;else if(D.hasOwnProperty(o))i=D[o],r="LEGACY_PANEL";else throw new Error("Invalid options.target: "+JSON.stringify(t.target));n.runCommand(e.content,{targetType:r,windowTag:i,context:t.appContext,window:t.window})}var ge={parse:le,launch:ce,LinkType:m};class fe{#t;#n;#e;constructor(t){this.#t=t}async mount(){if(this.#e!==void 0)throw new Error("This WebRoot has already been mounted!");const t=new H;this.#n=t;const n=this.#t.ownerDocument,r={},i={},o=new Z(n,t,r,i),g=new P(o);this.#e=new j(g),this.#e.content=t;const u=this.#e.getDomElement();this.#t.appendChild(u),this.#e.notifyWidgetAttachedToDoc(n),this.#e.importFontConfigLink(this.#t),await this.#e.getStylesheetsLoadedP()}render(t){if(this.#e===void 0)throw new Error("This WebRoot needs to be mounted first!");Y.isWidget(t)?(this.#n.removeAllChildren(),this.#n.addChild(t,{grow:1})):z.render(t,this.#n)}unmount(){if(this.#e===void 0)throw new Error("This WebRoot is not mounted!");this.#n.removeAllChildren(),this.#n=void 0,this.#e.getDomElement().remove();const n=this.#t.ownerDocument;this.#e.notifyWidgetRemovedFromDoc(n),this.#e=void 0}__private_demo_app_only_import_styles__(){this.#e.importStyles(this.#t)}}let P={extends:{public:{super:V}},init:function(e){this.initSuper(e)},virtual:{override:{commandtronManager:{get:function(){}},delegate:{get:function(){},set:function(){}},parent:{get:function(){},set:function(){}}}}};P=s.class.create(P);function Ce(e){return Q.setImpl(ge),new fe(e)}export{Ce as createRoot};
